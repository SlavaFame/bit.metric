<?php if (!defined("B_PROLOG_INCLUDED") || B_PROLOG_INCLUDED !== true) die();

/** @var array $arParams */
/** @var array $arResult */
/** @global CMain $APPLICATION */
/** @global CUser $USER */
/** @global CDatabase $DB */
/** @var CBitrixComponentTemplate $this */
/** @var string $templateName */
/** @var string $templateFile */
/** @var string $templateFolder */
/** @var string $componentPath */ 
/** @var CBitrixComponent $component */

use Bitrix\Main\Localization\Loc;
use Bitrix\Main\UI\Extension;
use Bitrix\Main\Config\Option;

$module_id   = 'bit.metric';
$colorOption = Option::get($module_id, 'color_picker', '#dd046a'); // Значение по умолчанию, если не установлено  

Loc::loadMessages(__FILE__);
$this->addExternalJS($templateFolder . "/lib/moment.min.js");
$this->addExternalJS($templateFolder . "/lib/chart.js");
$this->addExternalJS($templateFolder . "/lib/jquery.js"); 

Extension::load("ui.select");
Extension::load("ui.buttons.icons");

function bit_create_metric($aRes, $arData, $summa = 0, $type = '', $head, $arParams = array())
{
    global $APPLICATION;
    unset($arData['AVG_TIME']);
    ?>
    <div class="data-table-wrapper scrollbar-inner">
        <table class="data-table">
            <thead>
            <tr>
                <th></th>
                <th>
                    <?= $head["NAME"] ?>
                </th>
                <th class="data-table__users">
                    <?= $head["VALUE"] ?>
                </th>
                <? if ($summa):?>
                    <th>
                        <?= $head["VALUE"] ?>, %
                    </th>
                <?endif; ?>
            </tr>
            </thead>
            <tbody>
            <?
            $cnt = 0;
            foreach ($arData as $name => $data) {
                if ($type == 'source') {
                    $name = Loc::getMessage('BIT_METRICA_SOURCE_' . $name);
                }
                if ($type == 'user') {
                    $value = $aRes[$cnt];
                } elseif ($type == 'page') {
                    $value = $data['USER_CNT_ON_PAGE'];
                } elseif ($type == 'personal') {
                    $value = $data["DATE_CREATE"]->format('d.m.Y H:i:s');
                }
                $cnt++;
                ?>
                <tr>
                    <td><?= $cnt ?>.</td>
                    <td class="data-table__country">
                        <? if ($type == 'user'):?>
                            <a><?= $data ?></a>
                        <? elseif ($type == 'page'):?>
                            <a><?= $data["TITLE"] ?: "no title" ?></a>
                            <span class="detail-data__path wrapped">(<?= $data["URL"] ?>)</span>
                        <? elseif ($type == 'href'):?>
                            <a><?= $name ?></a>
                        <? elseif ($type == 'personal'):?>
                            <a><?= $data["NAME"] ?></a>
                            <span class="detail-data__path">(<?= $data["EMAIL"] ?>)</span>
                        <? else:?>
                            <?= $name ?: "(not set)" ?>
                        <?endif; ?>
                    </td>
                    <td class="data-table__users">
                        <?= $value ?>
                    </td>
                    <? if ($summa):?>
                        <? $prc = round($value / $summa * 100, 2) ?>
                        <td>
                            <div class="data-table__percentage">
                                <span style="width: <?= $prc ?>%;"></span>
                                <span><?= number_format($prc, 2, ',', '') ?>&nbsp;%</span>
                            </div>
                        </td>
                    <?endif; ?>
                </tr>
                <?
            }
            ?>
            </tbody>
        </table>
    </div>
    <?
}

function bit_show_user_stats($data)
{ ?>
    <table class="data-table">
        <thead>
        <tr>
            <th></th>
            <th>
                Параметр
            </th>
            <th>
                Значение
            </th>
        </tr>
        </thead>
        <tbody>
        <?
        $i = 1;
        foreach ($data as $name => $param) { ?>
            <tr>
                <td><?= $i++ ?>.</td>
                <td><?= Loc::getMessage('BIT_METRICA_' . $name); ?></td>
                <td><?= number_format($param) ?></td>
            </tr>
        <? } ?>
        </tbody>
    </table>
    <?php
}
?>

<div class="box-metrics-simple">
    <div class="container">
        <div class="clearfix">
            <? include('calendar.php'); ?>
        </div>
        <div class="diagram">
            <canvas id="diagramAnalytics" style="margin:0; width:100%; height:200px;"></canvas>
        </div>
        <div class="gen-data">
            <div class="gen-data__side gen-data__side_left">
                <ul class="stat-data">
                    <li class="stat-data__item">
                        <div class="stat-data__image stat-data__image_users">
                            <svg width="48" height="48" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"> 
                                <path d="M24 17.3972C24 13.8118 21.9702 10.624 18.7774 9.10172C19.394 8.25869 19.7325 7.24606 19.7325 6.18701C19.7325 3.46637 17.519 1.25293 14.7984 1.25293C12.5005 1.25293 10.523 2.84486 9.99955 5.03027C9.73927 4.98766 9.47412 4.95978 9.20195 4.95978C6.47804 4.95978 4.26226 7.17322 4.26226 9.89386C4.26226 10.7904 4.50089 11.6459 4.9509 12.406C2.00596 13.5275 0 16.392 0 19.5867V22.747H18.4036V19.5867C18.4036 19.4031 18.3938 19.2213 18.3808 19.0401H24V17.3972ZM14.7984 2.21296C16.9899 2.21296 18.7725 3.9956 18.7725 6.18701C18.7725 7.2131 18.3834 8.18859 17.686 8.92359L17.663 8.94655L18.0024 9.2859L17.6583 8.95123C16.8966 9.73499 15.8808 10.1667 14.7985 10.1667C14.5737 10.1667 14.3497 10.1406 14.1271 10.1023C14.1299 10.0328 14.1356 9.96391 14.1356 9.89391C14.1356 7.78035 12.7975 5.97822 10.926 5.2768C11.3388 3.50557 12.9386 2.21296 14.7984 2.21296ZM9.20204 5.91986C11.393 5.91986 13.1757 7.7025 13.1757 9.89391C13.1757 10.7972 12.8794 11.6517 12.3193 12.3647C12.0347 12.7243 11.6971 13.0264 11.3217 13.2636C11.297 13.2792 11.2702 13.2911 11.2452 13.3061C11.1436 13.3672 11.0411 13.4272 10.9345 13.4787C10.8762 13.507 10.8147 13.5281 10.7551 13.5534C10.6788 13.5858 10.6039 13.6214 10.5256 13.649C10.4063 13.6909 10.2837 13.7242 10.1603 13.7547C10.1393 13.7599 10.1193 13.7678 10.0982 13.7727C9.95596 13.8053 9.81127 13.8297 9.66478 13.8466C9.66176 13.8469 9.65888 13.8478 9.65586 13.8481C9.50629 13.865 9.35483 13.8736 9.202 13.8736C9.04873 13.8736 8.89677 13.865 8.74682 13.8481C7.84704 13.7466 7.01697 13.3456 6.38001 12.7045C6.27402 12.5978 6.1734 12.4844 6.07873 12.3648C5.51859 11.6518 5.22234 10.7972 5.22234 9.89396C5.22234 7.7025 7.00781 5.91986 9.20204 5.91986ZM17.4436 21.7871H0.959984V19.5867C0.959984 16.702 2.82842 14.1244 5.54063 13.2136C5.56778 13.2436 5.59825 13.2694 5.62599 13.2986C5.68303 13.3586 5.74167 13.4163 5.80129 13.4731C5.87232 13.5407 5.94472 13.6062 6.01926 13.6692C6.0817 13.7219 6.14479 13.7731 6.20953 13.8226C6.28723 13.8819 6.36675 13.9379 6.44757 13.9924C6.51436 14.0373 6.5811 14.0817 6.64989 14.1232C6.73413 14.1741 6.82046 14.2206 6.90753 14.2662C6.97749 14.3029 7.04695 14.34 7.11862 14.3733C7.20993 14.4157 7.30352 14.4524 7.39737 14.4891C7.46869 14.517 7.53909 14.5465 7.61177 14.5711C7.71205 14.605 7.81467 14.6319 7.91729 14.6593C7.98685 14.6779 8.0553 14.6994 8.12584 14.7149C8.24143 14.7404 8.35935 14.7575 8.47728 14.7748C8.53744 14.7835 8.59642 14.7965 8.65712 14.8031C8.83681 14.8226 9.01845 14.8336 9.2019 14.8336C9.38495 14.8336 9.56626 14.8227 9.74561 14.8031C9.80557 14.7965 9.86382 14.7837 9.92325 14.7751C10.0416 14.7577 10.1599 14.7405 10.276 14.7149C10.3457 14.6995 10.4132 14.6782 10.482 14.6599C10.5852 14.6323 10.6884 14.6051 10.7893 14.5709C10.861 14.5467 10.9303 14.5175 11.0006 14.49C11.0954 14.4529 11.19 14.4157 11.2822 14.3728C11.3526 14.3401 11.4207 14.3035 11.4894 14.2675C11.5777 14.2212 11.6652 14.174 11.7506 14.1223C11.8182 14.0814 11.8837 14.0378 11.9493 13.9936C12.0312 13.9385 12.1116 13.8818 12.1902 13.8216C12.2541 13.7728 12.3165 13.7221 12.3782 13.6698C12.4532 13.6065 12.5261 13.5406 12.5975 13.4725C12.6569 13.4158 12.7152 13.3584 12.772 13.2986C12.7998 13.2692 12.8305 13.2433 12.8577 13.2131C15.5727 14.1197 17.4435 16.6974 17.4435 19.5867V21.7871H17.4436ZM23.04 18.0802H18.247C17.7291 15.5147 15.9225 13.3433 13.4476 12.4054C13.6985 11.9814 13.8839 11.5281 13.9975 11.0535C14.2631 11.0973 14.5303 11.1267 14.7984 11.1267C16.0293 11.1267 17.1867 10.6735 18.0985 9.85179C21.1082 11.162 23.04 14.0887 23.04 17.3972V18.0802H23.04Z" 
                                fill="<?= htmlspecialchars($colorOption) ?>"/> 
                            </svg>
                        </div>
                        <div class="stat-data__content">
                            <div class="stat-data__title">
                                <?= Loc::getMessage('BIT_METRICA_TABLE_HEAD_C3') ?>
                            </div>
                            <div class="stat-data__value">
                                <?= $arResult["ALL_USER_CNT"] ?>
                            </div>
                        </div>
                    </li>

                    <li class="stat-data__item">
                        <div class="stat-data__image stat-data__image_new-users">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="<?= htmlspecialchars($colorOption) ?>" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12.0052 7.15356C9.93741 7.15356 8.25516 8.83581 8.25516 10.9036C8.25516 12.9713 9.93741 14.6536 12.0052 14.6536C14.073 14.6536 15.7552 12.9713 15.7552 10.9036C15.7552 8.83581 14.073 7.15356 12.0052 7.15356ZM12.0052 13.7161C10.4543 13.7161 9.19266 12.4544 9.19266 10.9036C9.19266 9.35275 10.4543 8.09106 12.0052 8.09106C13.556 8.09106 14.8177 9.35275 14.8177 10.9036C14.8177 12.4544 13.556 13.7161 12.0052 13.7161Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                <path d="M19.9153 4.34106H13.9736L12.4687 1.76111C12.3847 1.61711 12.2305 1.52856 12.0637 1.52856C11.897 1.52856 11.7428 1.61716 11.6588 1.76116L10.1539 4.34106H4.21219C2.98448 4.34106 1.98562 5.33992 1.98562 6.56763V20.3958C1.98562 21.6235 2.98448 22.6223 4.21219 22.6223H19.9153C21.143 22.6223 22.1419 21.6235 22.1419 20.3958V6.56763C22.1419 5.33992 21.1431 4.34106 19.9153 4.34106ZM6.5325 21.6848V18.3333C6.5325 17.0797 7.5758 16.0598 8.82937 16.0598H15.1809C16.4345 16.0598 17.4544 17.0797 17.4544 18.3333V21.6848H6.5325ZM21.2044 20.3958C21.2044 21.1065 20.6261 21.6848 19.9153 21.6848H18.3919V18.3333C18.3919 16.5627 16.9515 15.1223 15.1809 15.1223H8.82937C7.05886 15.1223 5.595 16.5627 5.595 18.3333V21.6848H4.21219C3.50137 21.6848 2.92312 21.1065 2.92312 20.3958V6.56763C2.92312 5.85686 3.50137 5.27856 4.21219 5.27856H10.4231C10.5899 5.27856 10.744 5.18997 10.828 5.04597L12.0638 2.92764L13.2995 5.04602C13.3835 5.19002 13.5377 5.27856 13.7044 5.27856H19.9154C20.6261 5.27856 21.2044 5.85686 21.2044 6.56763L21.2044 20.3958Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/> 
                            </svg>
                        </div>
                        <div class="stat-data__content">
                            <div class="stat-data__title">
                                <?= Loc::getMessage('BIT_METRICA_TABLE_HEAD_C4') ?>
                            </div>
                            <div class="stat-data__value">
                                <?= $arResult["NEW_USER_CNT"] ?>
                            </div>
                        </div>
                    </li>

                    <li class="stat-data__item">
                        <div class="stat-data__image stat-data__image_sessions"> 
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="<?= htmlspecialchars($colorOption) ?>" xmlns="http://www.w3.org/2000/svg">
                                <path d="M21.7297 18.8108H2.27027C1.84019 18.8108 1.42772 18.64 1.12361 18.3359C0.819496 18.0317 0.648647 17.6193 0.648647 17.1892V2.91892C0.648647 2.48884 0.819496 2.07638 1.12361 1.77226C1.42772 1.46815 1.84019 1.2973 2.27027 1.2973H21.7297C22.1598 1.2973 22.5723 1.46815 22.8764 1.77226C23.1805 2.07638 23.3514 2.48884 23.3514 2.91892V17.1892C23.3514 17.6193 23.1805 18.0317 22.8764 18.3359C22.5723 18.64 22.1598 18.8108 21.7297 18.8108ZM2.27027 1.94595C2.01222 1.94595 1.76474 2.04846 1.58227 2.23093C1.39981 2.4134 1.2973 2.66088 1.2973 2.91892V17.1892C1.2973 17.4472 1.39981 17.6947 1.58227 17.8772C1.76474 18.0597 2.01222 18.1622 2.27027 18.1622H21.7297C21.9878 18.1622 22.2353 18.0597 22.4177 17.8772C22.6002 17.6947 22.7027 17.4472 22.7027 17.1892V2.91892C22.7027 2.66088 22.6002 2.4134 22.4177 2.23093C22.2353 2.04846 21.9878 1.94595 21.7297 1.94595H2.27027Z" 
                                fill="<?= htmlspecialchars($colorOption) ?>"/>
                                <path d="M16.8649 22.7027H7.13513C7.04912 22.7027 6.96662 22.6685 6.9058 22.6077C6.84498 22.5469 6.81081 22.4644 6.81081 22.3784C6.81081 21.7763 7.05 21.1988 7.47576 20.773C7.90152 20.3473 8.47897 20.1081 9.08108 20.1081H14.9189C15.521 20.1081 16.0985 20.3473 16.5242 20.773C16.95 21.1988 17.1892 21.7763 17.1892 22.3784C17.1892 22.4644 17.155 22.5469 17.0942 22.6077C17.0334 22.6685 16.9509 22.7027 16.8649 22.7027ZM7.49189 22.054H16.5081C16.4333 21.6878 16.2343 21.3586 15.9447 21.1222C15.6551 20.8858 15.2928 20.7567 14.9189 20.7567H9.08108C8.70725 20.7567 8.34487 20.8858 8.05527 21.1222C7.76568 21.3586 7.56666 21.6878 7.49189 22.054Z" 
                                fill="<?= htmlspecialchars($colorOption) ?>"/>
                                <path d="M14.5946 20.7568H9.40541C9.31939 20.7568 9.2369 20.7226 9.17607 20.6618C9.11525 20.601 9.08108 20.5185 9.08108 20.4324V18.4865C9.08108 18.4005 9.11525 18.318 9.17607 18.2572C9.2369 18.1963 9.31939 18.1622 9.40541 18.1622H14.5946C14.6806 18.1622 14.7631 18.1963 14.8239 18.2572C14.8847 18.318 14.9189 18.4005 14.9189 18.4865V20.4324C14.9189 20.5185 14.8847 20.601 14.8239 20.6618C14.7631 20.7226 14.6806 20.7568 14.5946 20.7568ZM9.72973 20.1081H14.2703V18.8108H9.72973V20.1081Z" 
                                fill="<?= htmlspecialchars($colorOption) ?>"/>
                                <path d="M0.959999 15.5676H23.0141V16.2162H0.959999V15.5676Z" 
                                fill="<?= htmlspecialchars($colorOption) ?>"/>
                                <path d="M10.6897 16.8649H13.2843V17.5135H10.6897V16.8649Z" 
                                fill="<?= htmlspecialchars($colorOption) ?>"/>
                                <path d="M14.3935 12.4054C14.3084 12.405 14.2269 12.3712 14.1665 12.3113L12.2432 10.3784L11.7211 11.9448C11.7001 12.0072 11.6606 12.0617 11.6079 12.1011C11.5552 12.1405 11.4917 12.1629 11.4259 12.1654C11.3583 12.1709 11.2907 12.1552 11.2325 12.1203C11.1743 12.0854 11.1285 12.0331 11.1016 11.9708L8.35135 5.54917C8.32629 5.48974 8.31951 5.42419 8.33189 5.36089C8.34427 5.29759 8.37525 5.23942 8.42086 5.19381C8.46646 5.1482 8.52463 5.11723 8.58793 5.10485C8.65123 5.09247 8.71679 5.09924 8.77622 5.1243L15.1978 7.87457C15.2601 7.90149 15.3124 7.94725 15.3473 8.00543C15.3822 8.06361 15.398 8.13128 15.3924 8.1989C15.39 8.26466 15.3675 8.32811 15.3281 8.38082C15.2887 8.43354 15.2343 8.47302 15.1719 8.49403L13.6216 9.01295L15.5449 10.9362C15.6053 10.997 15.6392 11.0792 15.6392 11.1648C15.6392 11.2505 15.6053 11.3327 15.5449 11.3935L14.6238 12.3243C14.5605 12.3803 14.4779 12.4094 14.3935 12.4054ZM12.1005 9.46376C12.1435 9.46394 12.1859 9.47263 12.2254 9.48933C12.265 9.50604 12.3008 9.53042 12.3308 9.56106L14.3935 11.6238L14.8541 11.1632L12.7881 9.10052C12.7492 9.06113 12.721 9.01243 12.7063 8.95906C12.6915 8.9057 12.6906 8.84944 12.7038 8.79566C12.7162 8.74204 12.7421 8.69248 12.779 8.65163C12.8159 8.61077 12.8625 8.57998 12.9146 8.56214L14.1697 8.14701L9.27892 6.04863L11.3741 10.9394L11.7924 9.68755C11.8098 9.63488 11.8404 9.58755 11.8813 9.55007C11.9222 9.5126 11.972 9.48623 12.0259 9.47349L12.1005 9.46376Z" 
                                fill="<?= htmlspecialchars($colorOption) ?>"/>
                            </svg>
                        </div>
                        <div class="stat-data__content">
                            <div class="stat-data__title">
                                <?= Loc::getMessage('BIT_METRICA_TABLE_HEAD_C5') ?>
                            </div>
                            <div class="stat-data__value">
                                <?= $arResult['STATICTIC_DATA']['CNT_SESSION'] ?>
                            </div>
                        </div>
                    </li>

                    <li class="stat-data__item">
                        <div class="stat-data__image stat-data__image_sessions-by-user">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M22.8571 2H1.14286C0.514266 2 0 2.51797 0 3.15083V18.282C0 18.9152 0.514266 19.4329 1.14286 19.4329H9.42858V21.1366H7.28573C7.04887 21.1366 6.85716 21.33 6.85716 21.5683C6.85716 21.8066 7.04887 22 7.28573 22H16.7323C16.9692 22 17.1609 21.8066 17.1609 21.5683C17.1609 21.33 16.9692 21.1366 16.7323 21.1366H14.5714V19.4329H22.8571C23.4857 19.4329 24 18.9148 24 18.282V3.15083C24 2.51797 23.4857 2 22.8571 2ZM0.857156 3.15083C0.857156 2.99488 0.988031 2.86311 1.14286 2.86311H22.8572C23.012 2.86311 23.1429 2.99483 23.1429 3.15083V15.4205H0.857156V3.15083ZM13.7143 21.1369H10.2857V19.4332H13.7143V21.1369ZM23.1429 18.282C23.1429 18.438 23.012 18.5697 22.8571 18.5697H1.14286C0.988031 18.5697 0.857156 18.438 0.857156 18.282V16.284H23.1429V18.282Z" 
                                fill="<?= htmlspecialchars($colorOption) ?>"/>
                                <path d="M13.574 9.39854C14.226 8.91226 14.6512 8.13395 14.6512 7.25396C14.6508 5.77942 13.4646 4.58452 12.0003 4.58429C10.536 4.58462 9.35001 5.77942 9.34941 7.25396C9.34973 8.13395 9.77423 8.91226 10.4268 9.39854C8.75911 10.0383 7.57228 11.6588 7.57195 13.5631C7.57195 13.6765 7.61766 13.788 7.69739 13.8683C7.77712 13.9486 7.88681 13.9946 7.99997 13.9946H16C16.1131 13.9946 16.2231 13.9486 16.3031 13.8683C16.3831 13.788 16.4286 13.6766 16.4286 13.5631C16.4283 11.6589 15.2415 10.0383 13.574 9.39854ZM10.2063 7.25401C10.2066 6.75343 10.4066 6.3046 10.7317 5.97657C11.058 5.64915 11.5035 5.4474 12 5.4474C12.4966 5.4474 12.9427 5.64882 13.2683 5.97657C13.5938 6.30456 13.7935 6.75343 13.7938 7.25401C13.7934 7.75402 13.5937 8.20285 13.2683 8.53145C12.9421 8.85887 12.4966 9.06029 12 9.06062C11.5035 9.06029 11.0578 8.8592 10.7321 8.53145C10.4066 8.20318 10.2069 7.75398 10.2063 7.25401ZM8.45686 13.1314C8.55431 12.3109 8.92312 11.5763 9.47456 11.02C10.1226 10.3683 11.0126 9.96624 12 9.96624C12.9874 9.96624 13.8774 10.368 14.5254 11.02C15.0769 11.576 15.4457 12.3109 15.5434 13.1314H8.45686Z" 
                                fill="<?= htmlspecialchars($colorOption) ?>"/>
                            </svg> 
                        </div>
                        <div class="stat-data__content">
                            <div class="stat-data__title">
                                <?= Loc::getMessage('BIT_METRICA_TABLE_HEAD_C6') ?>
                            </div>
                            <div class="stat-data__value">
                                <?= $arResult['SESSION_ON_USER'] ?>
                            </div>
                        </div>
                    </li>
                    <li class="stat-data__item">
                        <div class="stat-data__image stat-data__image_views">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <g clip-path="url(#clip0_4_23)">
                                    <path d="M17.5385 4.84617H13.8462C13.7187 4.84617 13.6154 4.74283 13.6154 4.6154V0.923095C13.6154 0.829772 13.6716 0.745587 13.7579 0.709864C13.844 0.674234 13.9434 0.693849 14.0093 0.759895L17.7016 4.4522C17.7677 4.5182 17.7874 4.61748 17.7516 4.7037C17.716 4.78996 17.6318 4.84617 17.5385 4.84617ZM14.0769 4.38463H16.9813L14.0769 1.48022V4.38463Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M17.5385 23.3078H0.923076C0.795645 23.3078 0.692307 23.2045 0.692307 23.077V0.923152C0.692307 0.795721 0.795645 0.692383 0.923076 0.692383H13.8462C13.9736 0.692383 14.0769 0.795721 14.0769 0.923152V4.38469H17.5385C17.6659 4.38469 17.7692 4.48803 17.7692 4.61546V12.5333C17.7692 12.609 17.7321 12.68 17.6698 12.723C17.6076 12.7662 17.528 12.7759 17.4572 12.7492C16.543 12.4053 15.6387 12.2308 14.7692 12.2308C12.4675 12.2308 10.3854 13.4562 9.04403 14.4841C7.88409 15.3731 7.06172 16.2724 6.76389 16.6155C7.06172 16.9585 7.88409 17.8578 9.04403 18.7468C10.3854 19.7747 12.4675 21.0001 14.7692 21.0001C15.6387 21.0001 16.543 20.8257 17.4572 20.4817C17.5279 20.455 17.6076 20.4648 17.6698 20.5079C17.7321 20.551 17.7692 20.6219 17.7692 20.6976V23.077C17.7692 23.2045 17.6659 23.3078 17.5385 23.3078ZM1.15384 22.8462H17.3077V21.0249C16.4471 21.3148 15.5947 21.4616 14.7692 21.4616C12.3343 21.4616 10.1544 20.1808 8.75432 19.1062C7.24638 17.9489 6.32054 16.8082 6.28186 16.7603C6.21374 16.6757 6.21374 16.5552 6.28186 16.4707C6.32054 16.4227 7.24638 15.2821 8.75432 14.1247C10.1544 13.0502 12.3343 11.7693 14.7692 11.7693C15.5947 11.7693 16.4471 11.9161 17.3077 12.206V4.84623H13.8462C13.7187 4.84623 13.6154 4.74289 13.6154 4.61546V1.15392H1.15384V22.8462Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/> 
                                    <path d="M14.7692 21.4615C12.3343 21.4615 10.1544 20.1807 8.75432 19.1062C7.24638 17.9488 6.32054 16.8082 6.28186 16.7602C6.21374 16.6757 6.21374 16.5551 6.28186 16.4706C6.32054 16.4226 7.24638 15.282 8.75432 14.1246C10.1544 13.0501 12.3343 11.7692 14.7692 11.7692C15.6944 11.7692 16.6534 11.9536 17.6197 12.3172C20.8678 13.5395 23.1606 16.3514 23.2566 16.4705C23.3248 16.5551 23.3248 16.6757 23.2566 16.7602C23.1606 16.8793 20.8678 19.6912 17.6197 20.9135C16.6534 21.2771 15.6944 21.4615 14.7692 21.4615ZM6.76384 16.6153C7.06158 16.9583 7.884 17.8577 9.04403 18.7467C10.3854 19.7747 12.4675 21 14.7692 21C15.6387 21 16.543 20.8256 17.4572 20.4816C20.1738 19.4593 22.2585 17.2077 22.7742 16.6154C22.2585 16.023 20.1738 13.7715 17.4572 12.7492C16.543 12.4052 15.6387 12.2308 14.7692 12.2308C12.4639 12.2308 10.3787 13.4597 9.0353 14.4908C7.87795 15.379 7.06043 16.2735 6.76384 16.6153Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M14.7692 19.1539C13.3695 19.1539 12.2308 18.0151 12.2308 16.6154C12.2308 15.2157 13.3695 14.077 14.7692 14.077C16.1689 14.077 17.3077 15.2157 17.3077 16.6154C17.3077 18.0151 16.1689 19.1539 14.7692 19.1539ZM14.7692 14.5385C13.624 14.5385 12.6923 15.4702 12.6923 16.6154C12.6923 17.7606 13.624 18.6923 14.7692 18.6923C15.9145 18.6923 16.8462 17.7606 16.8462 16.6154C16.8462 15.4702 15.9145 14.5385 14.7692 14.5385Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M9.23077 21.4615H2.76923C2.6418 21.4615 2.53846 21.3582 2.53846 21.2308C2.53846 21.1033 2.6418 21 2.76923 21H9.23077C9.3582 21 9.46154 21.1033 9.46154 21.2308C9.46154 21.3582 9.3582 21.4615 9.23077 21.4615Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M6.92308 19.6154H2.76923C2.6418 19.6154 2.53846 19.5121 2.53846 19.3846C2.53846 19.2572 2.6418 19.1539 2.76923 19.1539H6.92308C7.05051 19.1539 7.15384 19.2572 7.15384 19.3846C7.15384 19.5121 7.05051 19.6154 6.92308 19.6154Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M5.07692 17.7693H2.76923C2.6418 17.7693 2.53846 17.666 2.53846 17.5385C2.53846 17.411 2.6418 17.3077 2.76923 17.3077H5.07692C5.20435 17.3077 5.30769 17.411 5.30769 17.5385C5.30769 17.666 5.20435 17.7693 5.07692 17.7693Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M5.07692 15.9231H2.76923C2.6418 15.9231 2.53846 15.8198 2.53846 15.6923C2.53846 15.5648 2.6418 15.4615 2.76923 15.4615H5.07692C5.20435 15.4615 5.30769 15.5648 5.30769 15.6923C5.30769 15.8198 5.20435 15.9231 5.07692 15.9231Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M6.92308 14.077H2.76923C2.6418 14.077 2.53846 13.9737 2.53846 13.8462C2.53846 13.7187 2.6418 13.6154 2.76923 13.6154H6.92308C7.05051 13.6154 7.15384 13.7187 7.15384 13.8462C7.15384 13.9737 7.05051 14.077 6.92308 14.077Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M9.23077 12.2308H2.76923C2.6418 12.2308 2.53846 12.1275 2.53846 12C2.53846 11.8725 2.6418 11.7692 2.76923 11.7692H9.23077C9.3582 11.7692 9.46154 11.8725 9.46154 12C9.46154 12.1275 9.3582 12.2308 9.23077 12.2308Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M15.6923 10.3846H2.76923C2.6418 10.3846 2.53846 10.2813 2.53846 10.1539C2.53846 10.0264 2.6418 9.9231 2.76923 9.9231H15.6923C15.8198 9.9231 15.9231 10.0264 15.9231 10.1539C15.9231 10.2813 15.8198 10.3846 15.6923 10.3846Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M15.6923 8.5385H2.76923C2.6418 8.5385 2.53846 8.43517 2.53846 8.30773C2.53846 8.1803 2.6418 8.07697 2.76923 8.07697H15.6923C15.8198 8.07697 15.9231 8.1803 15.9231 8.30773C15.9231 8.43517 15.8198 8.5385 15.6923 8.5385Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M15.6923 6.69231H2.76923C2.6418 6.69231 2.53846 6.58897 2.53846 6.46154C2.53846 6.33411 2.6418 6.23077 2.76923 6.23077H15.6923C15.8198 6.23077 15.9231 6.33411 15.9231 6.46154C15.9231 6.58897 15.8198 6.69231 15.6923 6.69231Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M12 4.84618H2.76923C2.6418 4.84618 2.53846 4.74284 2.53846 4.61541C2.53846 4.48798 2.6418 4.38464 2.76923 4.38464H12C12.1275 4.38464 12.2308 4.48798 12.2308 4.61541C12.2308 4.74284 12.1275 4.84618 12 4.84618Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M12 2.99999H2.76923C2.6418 2.99999 2.53846 2.89665 2.53846 2.76922C2.53846 2.64179 2.6418 2.53845 2.76923 2.53845H12C12.1275 2.53845 12.2308 2.64179 12.2308 2.76922C12.2308 2.89665 12.1275 2.99999 12 2.99999Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                </g>
                                <defs>
                                    <clipPath id="clip0_4_23">
                                        <rect width="48" height="48" fill="white"/>
                                    </clipPath>
                                </defs> 
                            </svg>
                        </div>
                        <div class="stat-data__content">
                            <div class="stat-data__title">
                                <?= Loc::getMessage('BIT_METRICA_TABLE_HEAD_C7') ?>
                            </div>
                            <div class="stat-data__value">
                                <?= $arResult['STATICTIC_DATA']['CNT_PAGE'] ?>
                            </div>
                        </div>
                    </li>
                    <li class="stat-data__item">
                        <div class="stat-data__image stat-data__image_views-by-session">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <g clip-path="url(#clip0_4_113)">
                                    <path d="M18.1764 23.0323H5.82365C5.66337 23.0323 5.53352 22.9026 5.53333 22.7421C5.53314 22.5749 5.53806 21.9685 5.53806 21.9685C5.5373 21.6213 5.56622 21.2682 5.62425 20.9225C5.6594 20.7135 5.70798 20.4978 5.76827 20.2808C5.79833 20.1461 5.8331 20.019 5.8711 19.907C6.03308 19.4282 6.43189 18.4865 7.2832 17.5598C7.84344 16.9504 8.82044 16.3159 9.31433 16.0602C9.32756 16.0521 9.34117 16.0453 9.35553 16.0392C9.36555 16.0341 9.37576 16.0292 9.38521 16.0245C9.3939 16.0171 9.40354 16.008 9.41356 15.9974L9.99893 15.1081C9.58632 14.7492 9.18032 14.2436 8.76449 13.5722C8.48362 13.1188 8.2294 12.6357 8.0075 12.134C7.42477 11.9974 6.95508 11.5604 6.78724 10.9835C6.62809 10.4373 6.77212 9.83545 7.15411 9.40601C7.15279 9.39807 7.15127 9.39032 7.15014 9.38276C7.14768 9.36972 7.09438 9.02723 7.09438 9.02723C7.02464 8.53032 6.96548 7.78013 7.24767 6.95604C7.28131 6.857 7.31345 6.77629 7.33613 6.72242C7.35314 6.68121 7.3796 6.64473 7.41287 6.61544C7.50321 6.53662 7.59356 6.45894 7.68372 6.38106C7.71585 6.35347 7.74799 6.32587 7.78012 6.29828C7.60226 5.83709 7.55198 5.0971 8.26815 4.57259C8.46188 4.37451 9.82164 3.08753 12.2121 3.32606C12.8458 3.3236 14.0513 3.44722 15.1191 4.33406C16.1373 5.17025 16.4728 6.24082 16.5989 6.64398C16.9064 7.6259 16.8208 8.4377 16.7582 9.03063L16.7555 9.05653C16.7446 9.15973 16.7308 9.26633 16.7123 9.38428C17.0275 9.75153 17.1379 10.355 16.985 10.9484C16.8028 11.6556 16.3134 12.1633 15.7736 12.2387C15.5627 12.7275 15.3221 13.2008 15.0573 13.6474C14.6857 14.274 14.3283 14.7473 13.9716 15.083C14.0916 15.2007 14.2602 15.3716 14.5044 15.6211L15.2383 16.348C15.7872 16.6824 16.2843 17.0899 16.7162 17.5598C17.5675 18.4863 17.9664 19.428 18.1283 19.9068C18.4642 20.8998 18.4663 22.7236 18.4663 22.7418C18.4665 22.9024 18.3366 23.0323 18.1764 23.0323ZM6.11511 22.4516H17.8815C17.8645 21.8309 17.7923 20.7252 17.5787 20.0933C17.4313 19.6578 17.068 18.8009 16.2889 17.953C15.8867 17.5152 15.4223 17.1364 14.9091 16.8276C14.8891 16.8155 14.8709 16.8013 14.8545 16.785L14.6702 16.6026C14.1793 16.9295 12.9755 17.6999 12.0095 17.6999C12.0068 17.6999 12.0042 17.6999 12.0013 17.6999C11.0712 17.6742 9.90556 16.954 9.45306 16.6484C9.03308 16.889 8.23072 17.3874 7.71075 17.9531C6.93183 18.8009 6.56817 19.658 6.42093 20.0935C6.38993 20.185 6.35988 20.2959 6.33096 20.423C6.27256 20.6345 6.22852 20.8303 6.19676 21.0191C6.14422 21.3329 6.11776 21.6531 6.11851 21.9706C6.1187 21.9725 6.11662 22.2276 6.11511 22.4516ZM9.9375 16.2751C10.4573 16.6045 11.3691 17.0992 12.0136 17.1192C12.5427 17.1177 13.2928 16.8041 14.2451 16.1866C14.1978 16.1382 14.1472 16.0865 14.0952 16.033L13.4826 15.4262C13.3957 15.4656 13.2891 15.5109 13.1866 15.5459C12.1457 15.9018 11.2447 15.6988 10.8007 15.5459C10.6726 15.5017 10.5733 15.4627 10.4957 15.4327C10.4926 15.4313 10.4894 15.43 10.4862 15.4289C10.4465 15.4926 10.4055 15.5593 10.3641 15.6272C10.1978 15.8988 10.0624 16.1156 9.9375 16.2751ZM10.5998 14.8515C10.6372 14.8641 10.6735 14.8783 10.7073 14.8917C10.7792 14.9197 10.871 14.9558 10.9897 14.9966C11.3634 15.1255 12.1215 15.2966 12.9986 14.9964C13.1286 14.9518 13.2836 14.879 13.3586 14.8431C13.3599 14.842 13.3611 14.8412 13.3622 14.8403C13.7444 14.5509 14.1356 14.064 14.5581 13.3516C14.8397 12.8763 15.093 12.3693 15.3102 11.8446C15.3584 11.728 15.4765 11.6558 15.6022 11.6664C15.8931 11.6906 16.276 11.3734 16.4229 10.8036C16.5382 10.3571 16.4526 9.90595 16.2152 9.70616C16.1363 9.63963 16.0985 9.53662 16.1159 9.43512C16.1447 9.26766 16.1643 9.12835 16.1783 8.99623L16.1809 8.96996C16.2416 8.39744 16.3167 7.68506 16.045 6.81787C15.9224 6.42661 15.6353 5.50972 14.7496 4.7824C13.8143 4.00556 12.7534 3.90255 12.2026 3.90765C12.1915 3.90708 12.1803 3.90708 12.1695 3.90595C9.91444 3.67535 8.68549 4.9767 8.6732 4.98993C8.65959 5.00487 8.64447 5.0181 8.62784 5.03C7.96573 5.49989 8.36927 6.19564 8.38666 6.22513C8.45829 6.34553 8.43372 6.49995 8.32825 6.59219C8.23979 6.6695 8.15134 6.74548 8.06288 6.82184C7.99087 6.88365 7.91904 6.94545 7.84722 7.00783C7.8321 7.04639 7.8149 7.09232 7.79713 7.14448C7.55784 7.84326 7.60282 8.47267 7.6686 8.94293C7.6686 8.94312 7.71888 9.26577 7.72247 9.28693C7.72814 9.32058 7.73608 9.35989 7.74402 9.39959L7.75309 9.44438C7.77275 9.54361 7.73948 9.64587 7.66482 9.71448C7.35673 9.998 7.23104 10.4329 7.34444 10.8221C7.4639 11.2321 7.81924 11.5332 8.24962 11.5895C8.3515 11.6029 8.43864 11.6689 8.4789 11.7634C8.70363 12.2896 8.96579 12.7956 9.25781 13.2672C9.69991 13.9811 10.1377 14.502 10.5592 14.8157C10.5745 14.8263 10.5879 14.8384 10.5998 14.8515Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M22.6051 19.799H17.8312C17.6707 19.799 17.5409 19.6691 17.5409 19.5087C17.5409 19.3482 17.6707 19.2183 17.8312 19.2183H22.6051C23.054 19.2183 23.4194 18.85 23.4194 18.3973V2.36243C23.4194 1.91353 23.0572 1.54836 22.6123 1.54836H1.38773C0.942792 1.54836 0.580645 1.91353 0.580645 2.36243V18.4043C0.580645 18.8532 0.942792 19.2183 1.38773 19.2183H6.2425C6.40297 19.2183 6.53282 19.3482 6.53282 19.5087C6.53282 19.6691 6.40297 19.799 6.2425 19.799H1.38773C0.622417 19.799 0 19.1735 0 18.4043V2.36243C0 1.59334 0.622606 0.967712 1.38773 0.967712H22.6123C23.3776 0.967712 24 1.59334 24 2.36243V18.3973C24 19.1701 23.3742 19.799 22.6051 19.799Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M23.7097 16.4272H14.7488C14.5883 16.4272 14.4585 16.2974 14.4585 16.1369C14.4585 15.9764 14.5883 15.8466 14.7488 15.8466H23.7097C23.8701 15.8466 24 15.9764 24 16.1369C24 16.2974 23.8701 16.4272 23.7097 16.4272Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M9.49351 16.4272H0.290323C0.129851 16.4272 0 16.2974 0 16.1369C0 15.9764 0.129851 15.8466 0.290323 15.8466H9.49351C9.65398 15.8466 9.78383 15.9764 9.78383 16.1369C9.78383 16.2974 9.65398 16.4272 9.49351 16.4272Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M20.9907 18.0841H20.4859C20.3254 18.0841 20.1956 17.9543 20.1956 17.7938C20.1956 17.6335 20.3254 17.5035 20.4859 17.5035H20.9907C21.1512 17.5035 21.2811 17.6335 21.2811 17.7938C21.2811 17.9543 21.151 18.0841 20.9907 18.0841Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/> 
                                </g>
                                <defs>
                                    <clipPath id="clip0_4_113">
                                        <rect width="48" height="48" fill="white"/>
                                    </clipPath>
                                </defs>
                            </svg>
                        </div>
                        <div class="stat-data__content">
                            <div class="stat-data__title">
                                <?= Loc::getMessage('BIT_METRICA_TABLE_HEAD_C8') ?>
                            </div>
                            <div class="stat-data__value">
                                <?= $arResult['PAGES_FOR_SESSION'] ?>
                            </div>
                        </div>
                    </li>

                    <li class="stat-data__item">
                        <div class="stat-data__image stat-data__image_average-session">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <g clip-path="url(#clip0_4_58)">
                                    <path d="M20.4853 3.51469C18.2188 1.24819 15.2053 0 12 0C8.79469 0 5.78123 1.24819 3.51469 3.51469C1.24819 5.78123 0 8.79469 0 12C0 15.2053 1.24819 18.2188 3.51469 20.4853C5.78123 22.7518 8.79469 24 12 24C15.2053 24 18.2188 22.7518 20.4853 20.4853C22.7518 18.2188 24 15.2053 24 12C24 8.79469 22.7518 5.78123 20.4853 3.51469ZM12 23.0438C5.91042 23.0438 0.956156 18.0896 0.956156 12C0.956156 5.91037 5.91042 0.956156 12 0.956156C18.0896 0.956156 23.0438 5.91042 23.0438 12C23.0438 18.0896 18.0896 23.0438 12 23.0438Z" fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M12.4781 10.1978V5.06774C12.4781 4.80369 12.264 4.58966 12 4.58966C11.736 4.58966 11.5219 4.80369 11.5219 5.06774V10.1979C10.7248 10.4095 10.1355 11.1371 10.1355 12C10.1355 13.0281 10.9718 13.8646 12 13.8646C13.0282 13.8646 13.8645 13.0281 13.8645 12C13.8645 11.1371 13.2752 10.4095 12.4781 10.1978ZM12 12.9083C11.4991 12.9083 11.0917 12.5008 11.0917 12C11.0917 11.4991 11.4991 11.0916 12 11.0916C12.5009 11.0916 12.9083 11.4991 12.9083 12C12.9083 12.5008 12.5009 12.9083 12 12.9083Z" fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M21.8008 11.5219H20.749C20.485 11.5219 20.271 11.7359 20.271 12C20.271 12.264 20.485 12.4781 20.749 12.4781H21.8008C22.0649 12.4781 22.2789 12.264 22.2789 12C22.2789 11.7359 22.0649 11.5219 21.8008 11.5219Z" fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M21.2194 15.3053L20.2477 14.9028C20.0038 14.8018 19.7241 14.9176 19.6231 15.1615C19.522 15.4054 19.6379 15.6851 19.8818 15.7861L20.8535 16.1886C20.9133 16.2134 20.9753 16.2251 21.0363 16.2251C21.2239 16.2251 21.4019 16.114 21.4782 15.9299C21.5792 15.686 21.4634 15.4063 21.2194 15.3053Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M19.2344 18.5781L18.4907 17.8344C18.304 17.6477 18.0013 17.6477 17.8146 17.8344C17.6279 18.0211 17.6279 18.3238 17.8146 18.5105L18.5583 19.2543C18.6517 19.3477 18.774 19.3943 18.8964 19.3943C19.0187 19.3943 19.1411 19.3477 19.2344 19.2543C19.4212 19.0676 19.4212 18.7649 19.2344 18.5781Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M16.1481 20.8423L15.7456 19.8706C15.6445 19.6266 15.3648 19.5107 15.121 19.6118C14.877 19.7128 14.7612 19.9925 14.8622 20.2364L15.2647 21.2081C15.341 21.3923 15.519 21.5034 15.7066 21.5034C15.7676 21.5034 15.8296 21.4917 15.8894 21.4669C16.1334 21.3659 16.2493 21.0862 16.1481 20.8423Z" 
                                    fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M11.9522 20.2231C11.6881 20.2231 11.4741 20.4371 11.4741 20.7012V21.7529C11.4741 22.017 11.6881 22.231 11.9522 22.231C12.2162 22.231 12.4303 22.017 12.4303 21.7529V20.7012C12.4303 20.4371 12.2162 20.2231 11.9522 20.2231Z" fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M8.7907 19.5752C8.54686 19.4743 8.26715 19.5901 8.16609 19.834L7.76357 20.8057C7.66251 21.0496 7.77839 21.3293 8.02232 21.4303C8.08214 21.4551 8.14411 21.4668 8.20509 21.4668C8.39268 21.4668 8.57067 21.3557 8.64698 21.1716L9.0495 20.1998C9.15046 19.956 9.03459 19.6763 8.7907 19.5752Z" fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M6.11775 17.7668C5.93109 17.5801 5.62837 17.5801 5.44162 17.7668L4.69786 18.5106C4.51116 18.6973 4.51116 19 4.69786 19.1867C4.79123 19.2801 4.91358 19.3268 5.03592 19.3268C5.15826 19.3268 5.28065 19.2801 5.37398 19.1867L6.11775 18.443C6.30445 18.2563 6.30445 17.9535 6.11775 17.7668Z" fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M4.34044 15.0732C4.23933 14.8292 3.95968 14.7132 3.71579 14.8144L2.74407 15.2169C2.50008 15.3179 2.3843 15.5976 2.48532 15.8415C2.56158 16.0257 2.73957 16.1368 2.92721 16.1368C2.98814 16.1368 3.05016 16.1251 3.10997 16.1003L4.08169 15.6978C4.32563 15.5968 4.44146 15.3171 4.34044 15.0732Z" fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M3.25102 11.4263H2.19919C1.93515 11.4263 1.72112 11.6403 1.72112 11.9043C1.72112 12.1684 1.93515 12.3824 2.19919 12.3824H3.25097C3.51502 12.3824 3.72905 12.1684 3.72905 11.9043C3.7291 11.6403 3.51507 11.4263 3.25102 11.4263Z" fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M4.1182 8.11826L3.14648 7.71574C2.90264 7.61478 2.62293 7.73056 2.52187 7.97449C2.42085 8.21843 2.53668 8.49809 2.78062 8.5991L3.75234 9.00162C3.81215 9.02642 3.87412 9.03813 3.9351 9.03813C4.1227 9.03813 4.30068 8.92699 4.377 8.74287C4.47801 8.49898 4.36218 8.21927 4.1182 8.11826Z" fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M6.18534 5.39386L5.44163 4.6501C5.25492 4.4634 4.9522 4.4634 4.76545 4.6501C4.57875 4.8368 4.57875 5.13952 4.76545 5.32627L5.50922 6.07004C5.6026 6.16341 5.72494 6.21005 5.84728 6.21005C5.96963 6.21005 6.09202 6.16341 6.18534 6.07004C6.37205 5.88333 6.37205 5.58061 6.18534 5.39386Z" fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M9.13776 3.66794L8.7352 2.69622C8.63418 2.45223 8.35443 2.33641 8.11059 2.43747C7.8666 2.53848 7.75077 2.81819 7.85184 3.06208L8.25435 4.0338C8.33062 4.21792 8.5086 4.32906 8.69624 4.32906C8.75718 4.32906 8.8192 4.31734 8.87901 4.29255C9.12299 4.19153 9.23887 3.91188 9.13776 3.66794Z" fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M12.0478 1.67328C11.7838 1.67328 11.5697 1.88731 11.5697 2.15136V3.20314C11.5697 3.46719 11.7838 3.68122 12.0478 3.68122C12.3119 3.68122 12.5259 3.46719 12.5259 3.20314V2.15136C12.5259 1.88731 12.3119 1.67328 12.0478 1.67328Z" fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M15.9777 2.47406C15.7339 2.37305 15.4542 2.48888 15.3531 2.73281L14.9506 3.70453C14.8495 3.94847 14.9654 4.22813 15.2094 4.32914C15.2692 4.35394 15.3311 4.36566 15.3921 4.36566C15.5797 4.36566 15.7577 4.25452 15.834 4.07039L16.2365 3.09867C16.3375 2.85474 16.2217 2.57508 15.9777 2.47406Z" fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M19.3021 4.71776C19.1154 4.53101 18.8127 4.53101 18.626 4.71776L17.8822 5.46153C17.6955 5.64823 17.6955 5.95095 17.8822 6.1377C17.9756 6.23107 18.0979 6.27771 18.2203 6.27771C18.3426 6.27771 18.465 6.23107 18.5583 6.1377L19.3021 5.39393C19.4887 5.20723 19.4887 4.90451 19.3021 4.71776Z" fill="<?= htmlspecialchars($colorOption) ?>"/>
                                    <path d="M21.5148 8.06277C21.4138 7.81883 21.134 7.70286 20.8902 7.80402L19.9185 8.20653C19.6745 8.30755 19.5587 8.58725 19.6597 8.83114C19.7359 9.01527 19.9139 9.12641 20.1016 9.12641C20.1625 9.12641 20.2245 9.11469 20.2843 9.08989L21.256 8.68738C21.5 8.58641 21.6158 8.30671 21.5148 8.06277Z" fill="<?= htmlspecialchars($colorOption) ?>"/>
                                </g>
                                <defs>
                                    <clipPath id="clip0_4_58">
                                        <rect width="48" height="48" fill="white"/>
                                    </clipPath>
                                </defs>
                            </svg>
                        </div>
                        <div class="stat-data__content">
                            <div class="stat-data__title">
                                <?= Loc::getMessage('BIT_METRICA_TABLE_HEAD_C9') ?>
                            </div>
                            <div class="stat-data__value">
                                <?= $arResult['ANALITIK_PAGES']['AVG_TIME'] ?>
                            </div>
                        </div>
                    </li>

                </ul>
            </div>
            <div class="gen-data__side gen-data__side_right">
                <ul class="data-tabs">
                    <li class="data-tabs__item current" data-tab="<?= Loc::getMessage('BIT_METRICA_TAB_1') ?>">
                        <?= Loc::getMessage('BIT_METRICA_TAB_1') ?>
                    </li>
                    <li class="data-tabs__item" data-tab="<?= Loc::getMessage('BIT_METRICA_TAB_10') ?>">
                        <?= Loc::getMessage('BIT_METRICA_TAB_10') ?>
                    </li>
                    <li class="data-tabs__item" data-tab="<?= Loc::getMessage('BIT_METRICA_TAB_11') ?>">
                        <?= Loc::getMessage('BIT_METRICA_TAB_11') ?>
                    </li>
                    <li class="data-tabs__item" data-tab="<?= Loc::getMessage('BIT_METRICA_TAB_12') ?>">
                        <?= Loc::getMessage('BIT_METRICA_TAB_12') ?>
                    </li>
                </ul>
                <div class="tabs-content">
                    <div class="tabs-content__item current" data-tab="<?= Loc::getMessage('BIT_METRICA_TAB_1') ?>">
                        <? bit_create_metric(array_reverse($arResult['USER_CNT_FOR_CHARTS']), array_reverse($arResult['DAY_ARR']), $arResult['ALL_USER_CNT'], 'user', array("NAME" => Loc::getMessage('BIT_METRICA_TABLE_HEAD_C1'), "VALUE" => Loc::getMessage('BIT_METRICA_TABLE_HEAD_C3'))) ?>
                    </div>
                    <div class="tabs-content__item" data-tab="<?= Loc::getMessage('BIT_METRICA_TAB_10') ?>">
                        <? bit_create_metric(1, $arResult['ANALITIK_PAGES'], $arResult['ALL_USER_CNT'], 'page', array("NAME" => Loc::getMessage('BIT_METRICA_TAB_10'), "VALUE" => Loc::getMessage('BIT_METRICA_TABLE_HEAD_C3')), $arParams) ?>
                    </div>
                    <div class="tabs-content__item" data-tab="<?= Loc::getMessage('BIT_METRICA_TAB_11') ?>">
                        <? bit_create_metric(0, $arResult['USER_DETAIL'], 0, 'personal', array("NAME" => Loc::getMessage('BIT_METRICA_TABLE_HEAD_C3'), "VALUE" => Loc::getMessage('BIT_METRICA_TABLE_HEAD_11')), $arParams) ?>
                    </div>
                    <div class="tabs-content__item" data-tab="<?= Loc::getMessage('BIT_METRICA_TAB_12') ?>">
                        <? bit_show_user_stats($arResult['USER_STATISTIC']) ?>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div> 

<script>
$(document).ready(function () {
    let myLine;
    let selectedColor = '<?= htmlspecialchars($colorOption) ?>';

    var customTooltips = function (tooltip) {
        var tooltipEl = document.getElementById('chartjs-tooltip');

        if (!tooltipEl) {
            tooltipEl = document.createElement('div');
            tooltipEl.id = 'chartjs-tooltip';
            tooltipEl.innerHTML = '<table></table>';
            this._chart.canvas.parentNode.appendChild(tooltipEl);
        }

        if (tooltip.opacity === 0) {
            tooltipEl.style.opacity = 0;
            return;
        }

        tooltipEl.classList.remove('above', 'below', 'no-transform');
        if (tooltip.yAlign) {
            tooltipEl.classList.add(tooltip.yAlign);
        } else {
            tooltipEl.classList.add('no-transform');
        }

        function getBody(bodyItem) {
            return bodyItem.lines;
        }

        if (tooltip.body) {
            var titleLines = tooltip.title || [];
            var bodyLines = tooltip.body.map(getBody);

            var innerHtml = '<thead>';
            titleLines.forEach(function (title) {
                let formattedTitle = title.split('-');
                formattedTitle = formattedTitle[2] + '.' + formattedTitle[1] + '.' + formattedTitle[0];
                innerHtml += '<tr><th>' + formattedTitle + '</th></tr>';
            });
            innerHtml += '</thead><tbody>';

            bodyLines.forEach(function (body, i) {
                var colors = tooltip.labelColors[i];
                var style = 'background:' + colors.backgroundColor;
                style += '; border-color:' + colors.borderColor;
                style += '; border-width: 2px';
                innerHtml += '<tr><td>' + body + '</td></tr>';
            });
            innerHtml += '</tbody>';

            var tableRoot = tooltipEl.querySelector('table');
            tableRoot.innerHTML = innerHtml;
        }

        var positionY = this._chart.canvas.offsetTop;
        var positionX = this._chart.canvas.offsetLeft;

        tooltipEl.style.opacity = 1;
        tooltipEl.style.left = positionX + tooltip.caretX + 'px';
        tooltipEl.style.top = positionY + tooltip.caretY + 'px';
        tooltipEl.style.fontFamily = tooltip._bodyFontFamily;
        tooltipEl.style.fontSize = tooltip.bodyFontSize + 'px';
        tooltipEl.style.fontStyle = tooltip._bodyFontStyle;
        tooltipEl.style.padding = tooltip.yPadding + 'px ' + tooltip.xPadding + 'px';
    };

    var labels = ['<?=implode("','", $arResult["DAY_ARR"])?>'];
    var data = ['<?=implode("','", $arResult["USER_CNT_FOR_CHARTS"])?>'];

    window.onload = function () {
        var chartEl = document.getElementById('diagramAnalytics');
        myLine = new Chart(chartEl, {
            type: 'line',
            data: {
                labels: labels, 
                datasets: [{
                    label: '<?= Loc::getMessage('BIT_METRICA_TABLE_HEAD_C3'); ?>',
                    data: data,
                    borderColor: selectedColor,
                    pointBackgroundColor: "#FFFFFF",
                    fill: true,
                    borderWidth: 2,
                    lineTension: 0.1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
        document.querySelectorAll('.data-tabs__item.current').forEach(function(item) {
            item.style.backgroundColor = selectedColor;
        });

        document.querySelectorAll('.data-table tbody td a').forEach(function(link) {
            link.style.color = selectedColor;
         });

        document.querySelectorAll('.stat-data__image svg path').forEach(function(svg) {
            svg.style.fill = selectedColor;
        }); 
    };

    $(document).on('click', '.data-tabs .data-tabs__item', function () {
        if ($(this).hasClass('current')) {
            return false;
        }
        $('.data-tabs__item').css('background-color', '#E4E8EC');
        $('.data-tabs__item').removeClass('current');
        $('.tabs-content__item').removeClass('current'); 

        $(this).addClass('current');
        $(this).css('background-color', selectedColor);
        var target = $(this).data('tab');
        $('.tabs-content__item[data-tab="' + target + '"]').addClass('current');
    });
});

</script>